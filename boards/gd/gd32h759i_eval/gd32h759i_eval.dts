/*
 * Copyright (c) 2026 GigaDevice Semiconductor Inc.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

/dts-v1/;

#include <gd/gd32h7xx/gd32h759im.dtsi>
#include "gd32h759i_eval-pinctrl.dtsi"

/ {
	model = "GigaDevice GD32H759I-EVAL";
	compatible = "gd,gd32h759i-eval";

	chosen {
		zephyr,sram = &sram0;
		zephyr,dtcm = &dtcm;
		zephyr,flash = &flash0;
		zephyr,console = &usart0;
		zephyr,shell-uart = &usart0;
		zephyr,flash-controller = &fmc;
		zephyr,canbus = &can0;
	};

	leds {
		compatible = "gpio-leds";
		led0: led0 {
			gpios = <&gpiof 10 GPIO_ACTIVE_HIGH>;
		};
		led1: led1 {
			gpios = <&gpioa 6 GPIO_ACTIVE_HIGH>;
		};
	};

	pwmleds {
		compatible = "pwm-leds";

		/* NOTE: bridge TIMER1_CH2 (PB10) and LED1 (PE2) */
		pwm_led0: pwm_led0 {
			pwms = <&pwm1 2 PWM_MSEC(20) PWM_POLARITY_NORMAL>;
		};
		pwm_led1: pwm_led1 {
			pwms = <&pwm0 0 PWM_MSEC(20) PWM_POLARITY_NORMAL>;
		};
		pwm_led2: pwm_led2 {
			pwms = <&pwm0 1 PWM_MSEC(20) PWM_POLARITY_NORMAL>;
		};
		pwm_led3: pwm_led3 {
			pwms = <&pwm0 2 PWM_MSEC(20) PWM_POLARITY_NORMAL>;
		};
	};


	aliases {
		led0 = &led0;
		led1 = &led1;
		watchdog0 = &fwdgt;
		pwm-led0 = &pwm_led0;
		pwm-led1 = &pwm_led1;
		pwm-led2 = &pwm_led2;
		pwm-led3 = &pwm_led3;
	};
};

&timer0 {
	channels = <4>;
	prescaler = <9999>;
	alignedmode = <0x00>;
	counterdirection = <0x10>;
	deadtime = <200>;                  /* 1.06us */
	status = "okay";
	pwm0: pwm {
		status = "okay";
		pinctrl-0 = <&pwm0_default>;
		pinctrl-names = "default";
	};
};

&timer1 {
	channels = <4>;
	prescaler = <9999>;
	alignedmode = <0x00>;
	counterdirection = <0x10>;
	status = "okay";
	pwm1: pwm {
		status = "okay";
		pinctrl-0 = <&pwm1_default>;
		pinctrl-names = "default";
	};
};

&backup_sram {
	status = "okay";
};

&gpioa {
	status = "okay";
};

&gpiob {
	status = "okay";
};

&gpioc {
	status = "okay";
};

&gpiod {
	status = "okay";
};

&gpioe {
	status = "okay";
};

&gpiof {
	status = "okay";
};

&gpiog {
	status = "okay";
};

&gpioh {
	status = "okay";
};

&gpioj {
	status = "okay";
};

&gpiok {
	status = "okay";
};

&usart0 {
	status = "okay";
	current-speed = <115200>;
	pinctrl-0 = <&usart0_default>;
	pinctrl-names = "default";
};

&usart1 {
	status = "okay";
	current-speed = <115200>;
	pinctrl-0 = <&usart1_default>;
	pinctrl-names = "default";
};

&fwdgt {
	status = "okay";
};

&adc0 {
	status = "okay";
	pinctrl-0 = <&adc0_default>;
	pinctrl-names = "default";
	dmas = <&dma0 1 9 (3<<16) 0>;
	dma-names = "rx";
};

&dma0 {
	status = "okay";
};

&spi0 {
	status = "okay";
	pinctrl-0 = <&spi0_default>;
	pinctrl-names = "default";
	cs-gpios = <&gpioa 4 GPIO_ACTIVE_LOW>;
	dmas = <&dma0 0 48 (2<<16) 0>, <&dma0 1 47 (3<<16) 0>;
	dma-names = "tx", "rx";
};

&spi1 {
	status = "okay";
	pinctrl-0 = <&spi1_default>;
	pinctrl-names = "default";
	cs-gpios = <&gpioa 13 GPIO_ACTIVE_LOW>;
};

&spi2 {
	status = "okay";
	pinctrl-0 = <&spi2_default>;
	pinctrl-names = "default";
	cs-gpios = <&gpioa 4 GPIO_ACTIVE_LOW>;
};

&spi3 {
	status = "okay";
	pinctrl-0 = <&spi3_default>;
	pinctrl-names = "default";
	cs-gpios = <&gpioe 4 GPIO_ACTIVE_LOW>;
};

&spi4 {
	status = "okay";
	pinctrl-0 = <&spi4_default>;
	pinctrl-names = "default";
	cs-gpios = <&gpiof 6 GPIO_ACTIVE_LOW>;
};

&spi5 {
	status = "okay";
	pinctrl-0 = <&spi5_default>;
	pinctrl-names = "default";
	cs-gpios = <&gpioa 0 GPIO_ACTIVE_LOW>;
};

&can0 {
	pinctrl-0 = <&can0_default>;
	pinctrl-names = "default";
	bus-speed = <1000000>;
	bus-speed-data = <1000000>;
	sample-point = <800>;
	sample-point-data = <800>;
	status = "okay";
};

&can1 {
	pinctrl-0 = <&can1_default>;
	pinctrl-names = "default";
	bus-speed = <1000000>;
	bus-speed-data = <1000000>;
	sample-point = <800>;
	sample-point-data = <800>;
	status = "okay";
};

&can2 {
	pinctrl-0 = <&can2_default>;
	pinctrl-names = "default";
	bus-speed = <1000000>;
	bus-speed-data = <1000000>;
	sample-point = <800>;
	sample-point-data = <800>;
	status = "okay";
};
